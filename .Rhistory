library(Biostrings)
library(msa)
library(dplyr)
library(tidyverse)
library(genepop)
library(tidyr)
library(seqinr)
library(ape)
# 1. Import and align your DNA sequences
combinedseq <- readDNAStringSet("Data/sequences.fasta")
# CLEAN UP #####
# Clear environment
rm(list = ls())
# Clear console
cat("\014")  # ctrl+L
# 1. Import and align your DNA sequences
combinedseq <- readDNAStringSet("Data/sequences.fasta")
combinedseq
#### Creating a consensus ####
alignment_set <- DNAStringSet(combinedseq)
consensus <- consensusString(alignment_set)
print(consensus)
#### Creating an msa alignment ####
myFirstAlignment <- msa(combinedseq)
myFirstAlignment
print(myFirstAlignment, show="complete")
count_gaps <- function(sequence) {
#Search for the presence of "-" in the sequence
gap_positions <- grepl("-", sequence)
num_gaps <- sum(gap_positions)
return(num_gaps)
num_gaps_in_sequences <- sapply(consensus, count_gaps)
total_gaps <- sum(num_gaps_in_sequences)
print(total_gaps)
x
# Clear console
cat("\014")  # ctrl+L
print(total_gaps)
# CLEAN UP #####
# Clear environment
rm(list = ls())
# Clear packages
# requires the package pacman to work# CLEAN UP #####
# Clear environment
p_unload(all)  # Remove all add-ons
# Clear console
cat("\014")  # ctrl+L
